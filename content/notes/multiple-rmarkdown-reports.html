---
title: "Multiple RMarkdown Reports, Multiple Data Sets, Single File"
date: 2016-07-21T08:38:31-04:00
categories: ["notes"]
tags: ["R Markdown", "R"]
summary: "how to create 'templated' rmarkdown reports"
---



<p>Until recently I had yet to run into a scenario where I needed to use R Markdown to produce a “templated” set of reports. That is, a group of PDFs or HTML files with common R code (and therefore common report features, like figures, tables, summary statistics, etc.) executed dynamically on different data sets.</p>
<p>I encountered this problem when I was trying to automate a workflow for generating reports on publication data. The datasets are compiled individually for each department (Neurology, Pathology, etc.) but the final product (a PDF) features a common set of plots based on the input data set.</p>
<p>The <em>brute force</em> GUI solution here would be to:</p>
<ol style="list-style-type: decimal">
<li>Open up RStudio</li>
<li>Write an RMarkdown report that reads in the first data set</li>
<li>Click “Knit PDF”</li>
<li>Point the <code>read_csv()</code> in the RMarkdown file to the second data set</li>
<li>Click “Knit PDF”</li>
<li>Repeat steps 4 &amp; 5 until all reports have been generated</li>
</ol>
<p>I could have potentially &gt; 50 data sets. So the process above wasn’t going to work for me.</p>
<p>Instead I started looking around for ways to loop through a list of files and generate multiple PDF reports. Each PDF would be based on data from each file.</p>
<p>Stack Overflow features posts that speak to this issue. One post describes a similar problem, but in terms of <a href="http://stackoverflow.com/questions/15396755/using-loops-with-knitr-to-produce-multiple-pdf-reports-need-a-little-help-to"><strong>knitr</strong> with Sweave</a>. Another seems more relavent to my workflow (since I’m using RMarkdown rather than Sweave) but explains <a href="http://stackoverflow.com/questions/26304576/how-to-best-generate-multiple-html-files-from-rmarkdown-based-on-one-dataset">how to create multiple reports from a <em>single</em> data set</a>.</p>
<p>My solution borrows from the posts above. The basic premise here is that you can use a single R script to “drive” the rendering of your R Markdown file. <a href="http://brooksandrew.github.io/simpleblog/articles/render-reports-directly-from-R-scripts/">Another piece of documentation</a> I found does a great job detailing this idea.</p>
<p>With everything above in mind, here’s the workflow that works for me:</p>
<ol style="list-style-type: decimal">
<li>Move all data files to a “data” subdirectory of my project root</li>
<li>Check that data is prepared correctly (i.e. all columns are named the same, missing values are represented consistently)</li>
<li>Write an RMarkdown file (first code block below) that is generic enough to work for each data set</li>
<li><p>Write an R script (second code block below) that:</p>
<ol style="list-style-type: decimal">
<li>Loops through the data folder</li>
<li>Creates an individual object (<code>pubs</code>) based on the given file in the loop</li>
<li>Renders a PDF (using <code>rmarkdown::render()</code>) that is named accodring to the raw data file.</li>
<li>Run the R script</li>
</ol></li>
</ol>
<!--

```
---
title: "Publication Metrics"
author: "VP Nagraj"
date: "July 14, 2016"
output: pdf_document
---
```


```
## Warning: package 'knitr' was built under R version 3.4.3
```

```
## Warning: package 'dplyr' was built under R version 3.4.2
```

```
## 
## Attaching package: 'dplyr'
```

```
## The following object is masked from 'package:ggplot2':
## 
##     vars
```

```
## The following objects are masked from 'package:stats':
## 
##     filter, lag
```

```
## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union
```

```
## Warning: package 'tidyr' was built under R version 3.4.2
```



-->
